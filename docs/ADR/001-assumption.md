# ADR 001 — предположения о жизненном цикле Суда

Дата: 2025-11-18

## Контекст

Функциональная спецификация раздела «Суд» упоминает «жизненный цикл дела», статусы, роль возврата наказаний и режимы «исполнителей», но не фиксирует точные наборы значений, единицы длительности и место хранения конфигурации.

## Предположения

1. **Статусы дела.** Жизненный цикл использует перечисление `draft`, `issued`, `active`, `awaiting_revert`, `completed`, `cancelled`, `revoked`. `active` — наказания действуют; `awaiting_revert` — есть задачи для отката; `completed` и `revoked` — финальные состояния.
2. **Исполнители.** Чтобы покрыть сценарии «site/discord/minecraft», каждое дело хранит поле `executor` из закрытого списка. В UI по умолчанию `site`; Discord/Minecraft будут передаваться через API позже.
3. **Единицы длительности.** Бан/мут сохраняются в минутах, чтобы совпадать с инструментами Azuriom. Для удобства UI принимает целые минуты и шорткаты (`3h`, `6m`), а на сервере всё нормализуется в минуты.
4. **Хранение шаблонов.** Описания шаблонов лежат в таблице `socialprofile_court_templates`, а дефолты берутся из конфига и могут быть обновлены админами без деплоя.
5. **Связка ролей.** Конфигурация содержит ключи `ban_role`, `mute_role`, `novice_role` с ID ролей Azuriom. При выдаче наказаний роли меняются, а планировщик возвращает исходные значения.
6. **Повтор вебхуков.** Доставки вебхуков сохраняются со статусами (`pending`, `sent`, `failed`) и переотправляются тем же планировщиком для соблюдения требований аудита и наблюдаемости.

Весь код ниже опирается на эти предположения; любые изменения фиксируются новой ADR.
